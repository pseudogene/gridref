/*****************************************/
/** Usable Forms 2.0, November 2005     **/
/** Written by ppk, www.quirksmode.org  **/
/*****************************************/
var containerTag='DIV';var compatible=(document.getElementById&&document.getElementsByTagName&&document.createElement&&!(navigator.userAgent.indexOf('MSIE 5')!=-1&&navigator.userAgent.indexOf('Mac')!=-1));if(compatible){document.write('<style>.accessibility{display: none}</style>');var waitingRoom=document.createElement('div')}var hiddenFormFieldsPointers=new Object();function prepareForm(){if(!compatible)return;var a=document.createElement(containerTag);a.style.display='none';var x=document.getElementsByTagName('select');for(var i=0;i<x.length;i++)addEvent(x[i],'change',showHideFields);var x=document.getElementsByTagName(containerTag);var b=new Array;for(var i=0;i<x.length;i++){if(x[i].getAttribute('rel')){var y=getAllFormFields(x[i]);x[i].nestedRels=new Array();for(var j=0;j<y.length;j++){var c=y[j].getAttribute('rel');if(!c||c=='none')continue;x[i].nestedRels.push(c)}if(!x[i].nestedRels.length)x[i].nestedRels=null;b.push(x[i])}}while(b.length){var c=b[0].getAttribute('rel');if(!hiddenFormFieldsPointers[c])hiddenFormFieldsPointers[c]=new Array();var d=hiddenFormFieldsPointers[c].length;hiddenFormFieldsPointers[c][d]=b[0];var e=a.cloneNode(true);e.id=c+d;b[0].parentNode.replaceChild(e,b[0]);waitingRoom.appendChild(b.shift())}setDefaults();addEvent(document,'click',showHideFields)}function setDefaults(){var y=document.getElementsByTagName('input');for(var i=0;i<y.length;i++){if(y[i].checked&&y[i].getAttribute('rel'))intoMainForm(y[i].getAttribute('rel'))}var z=document.getElementsByTagName('select');for(var i=0;i<z.length;i++){if(z[i].options[z[i].selectedIndex].getAttribute('rel'))intoMainForm(z[i].options[z[i].selectedIndex].getAttribute('rel'))}}function showHideFields(e){if(!e)var e=window.event;var a=e.target||e.srcElement;if(a.nodeName=='LABEL'){var b=a.getAttribute('for')||a.getAttribute('htmlFor');a=document.getElementById(b)}if(!(a.nodeName=='SELECT'&&e.type=='change')&&!(a.nodeName=='INPUT'&&a.getAttribute('rel')))return;var c=a.getAttribute('rel');if(a.type=='checkbox'){if(a.checked)intoMainForm(c);else intoWaitingRoom(c)}else if(a.type=='radio'){removeOthers(a.form[a.name],c);intoMainForm(c)}else if(a.type=='select-one'){c=a.options[a.selectedIndex].getAttribute('rel');removeOthers(a.options,c);intoMainForm(c)}}function removeOthers(a,b){for(var i=0;i<a.length;i++){var c=a[i].getAttribute('rel');if(c==b)continue;intoWaitingRoom(c)}}function intoWaitingRoom(a){if(a=='none')return;var b=hiddenFormFieldsPointers[a];for(var i=0;i<b.length;i++){waitingRoom.appendChild(b[i]);if(b[i].nestedRels)for(var j=0;j<b[i].nestedRels.length;j++)intoWaitingRoom(b[i].nestedRels[j])}}function intoMainForm(a){if(a=='none')return;var b=hiddenFormFieldsPointers[a];for(var i=0;i<b.length;i++){var c=document.getElementById(a+i);c.parentNode.insertBefore(b[i],c);if(b[i].nestedRels){var d=getAllFormFields(b[i]);for(var j=0;j<d.length;j++){if(!d[j].getAttribute('rel'))continue;if(d[j].checked||d[j].selected)intoMainForm(d[j].getAttribute('rel'))}}}}function getAllFormFields(a){var b=new Array;var x=a.getElementsByTagName('input');for(var i=0;i<x.length;i++)b.push(x[i]);var y=a.getElementsByTagName('option');for(var i=0;i<y.length;i++)b.push(y[i]);return b}function addEvent(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}}addEvent(window,"load",prepareForm);function Array_push(){var a=0;for(a=0;a<arguments.length;a++){this[this.length]=arguments[a]}return this.length}if(typeof Array.prototype.push=="undefined"){Array.prototype.push=Array_push}function Array_shift(){var a=0;var b=this[0];for(a=0;a<this.length-1;a++){this[a]=this[a+1]}this.length--;return b}if(typeof Array.prototype.shift=="undefined"){Array.prototype.shift=Array_shift}